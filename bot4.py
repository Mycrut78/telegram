import nest_asyncio
nest_asyncio.apply()
import random
import asyncio
from telegram import Update, BotCommand
from telegram.ext import ApplicationBuilder, CommandHandler, ContextTypes, MessageHandler, filters
import openai
from openai import AsyncOpenAI


from dotenv import load_dotenv
import os
import logging

load_dotenv()

TOKEN = os.getenv("TELEGRAM_TOKEN")
openai.api_key = os.getenv("OPENAI_API_KEY")
WEBHOOK_URL = "https://telegram-l27s.onrender.com"
client = AsyncOpenAI(api_key=openai.api_key)


logging.basicConfig(level=logging.INFO)

chat_users = set()  # –º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ä–µ–∂–∏–º–µ —á–∞—Ç–∞

arsenals = {
    "üî• –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–∏–∫–æ–ª—ã –∏ –∫–∞–π—Ñ–æ–≤—ã–µ –¥–≤–∏–∂—É—Ö–∏": [
        "üòÇ –ó–∞–ª–∏–ø–Ω–∏ –Ω–∞ –º–µ–º–∞—Ö ‚Äî –ø—Ä–∏–¥—É–º—ã–≤–∞–π —Å–≤–æ–∏ –ø–æ–¥–ø–∏—Å–∏ –∏ —Å–º–µ–π—Å—è –¥–æ —Å–ª—ë–∑.",
        "üì∫ –í–±–µ–π –≤ YouTube ¬´How to‚Ä¶¬ª –∏ –≤—ã–±–µ—Ä–∏ –ø–µ—Ä–≤–æ–µ –≤–∏–¥–µ–æ ‚Äî —É—á–∏—Å—å —Ñ–µ—Ö—Ç–æ–≤–∞—Ç—å –º–æ—Ä–∫–æ–≤–∫–æ–π –∏–ª–∏ –∑–∞–≤—è–∑—ã–≤–∞—Ç—å –≥–∞–ª—Å—Ç—É–∫.",
        "üéØ –ü–æ–∏—â–∏ —Å—Ç—Ä–∞–Ω–Ω—ã–µ —á–µ–ª–ª–µ–Ω–¥–∂–∏ –≤ –¢–∏–∫–¢–æ–∫–µ ‚Äî –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø–æ—Å–º–µ—è—Ç—å—Å—è.",
        "üç™ –ù–∞–π–¥–∏ —Å–∞–º—ã–π —Å—Ç—Ä–∞–Ω–Ω—ã–π —Ä–µ—Ü–µ–ø—Ç –Ω–∞ –∫—É–ª–∏–Ω–∞—Ä–Ω–æ–º –∫–∞–Ω–∞–ª–µ –∏ –ø–æ–ø—Ä–æ–±—É–π –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å, –∫–∞–∫ —ç—Ç–æ –Ω–∞ –≤–∫—É—Å.",
        "‚è± –ó–∞–ø—É—Å—Ç–∏ —Ç–∞–π–º–µ—Ä –Ω–∞ 5 –º–∏–Ω—É—Ç –∏ –ø–∏—à–∏ —Å–ø–∏—Å–æ–∫ —Å–∞–º—ã—Ö –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã—Ö —Ü–µ–ª–µ–π, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ç–∞—Ç—å –∫–æ—Å–º–æ–Ω–∞–≤—Ç–æ–º-–µ–¥–∏–Ω–æ—Ä–æ–≥–æ–º.",
        "üé≤ –ü–æ–ø—Ä–æ—Å–∏ –º–µ–Ω—è –ø—Ä–∏–¥—É–º–∞—Ç—å –º–∏–Ω–∏-–∏–≥—Ä—É —Å —Ö–∞–æ—Å–æ–º –∏ –±–µ–∑ –ø—Ä–∞–≤–∏–ª ‚Äî —Å–∫—É–∫–∞ —É–±–µ–∂–∏—Ç!",
        "üé∂ –í–∫–ª—é—á–∏ –ø–µ—Å–Ω–∏ 80-—Ö –Ω–∞ –ø–æ–≤—Ç–æ—Ä –∏ —Ç–∞–Ω—Ü—É–π –∫–∞–∫ –∑–≤–µ–∑–¥–∞ MTV, –¥–∞–∂–µ –µ—Å–ª–∏ –¥–æ–º–∞ –æ–¥–∏–Ω.",
        "ü¶∏‚Äç‚ôÇÔ∏è –ü—Ä–æ–π–¥–∏ –∞–±—Å—É—Ä–¥–Ω—ã–π —Ç–µ—Å—Ç ¬´–∫–∞–∫–æ–π —Ç—ã —Å—É–ø–µ—Ä–≥–µ—Ä–æ–π¬ª ‚Äî —Å—é—Ä–ø—Ä–∏–∑ –∏ —Å–º–µ—Ö –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã.",
        "üìù –ù–∞–ø–∏—à–∏ —Å–∞–º—ã–π –±–µ—Å–ø–æ–ª–µ–∑–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤ –º–∏—Ä–µ ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∫ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –≤—Å—Ç—Ä–µ—á—É –∏ –Ω–µ –ø–æ–ø–∞—Å—Ç—å—Å—è."
    ],
    "üß† –î–ª—è —É–º–∞ –∏ –ª—ë–≥–∫–æ–π –ø—Ä–æ–∫–∞—á–∫–∏": [
        "üìö –£—á–∏—Å—å 30 –º–∏–Ω—É—Ç ‚Äî –∫–æ–¥, —Ä–∏—Å–æ–≤–∞–Ω–∏–µ –∏–ª–∏ –ø–æ—á–µ–º—É —è–ø–æ–Ω—Ü—ã –ª—é–±—è—Ç —Ö–∞–π-—Ç–µ–∫ —Ç—É–∞–ª–µ—Ç—ã.",
        "üåê –õ–∏—Å—Ç–∞–π —Å–ª—É—á–∞–π–Ω—ã–µ —Å—Ç–∞—Ç—å–∏ –≤ –í–∏–∫–∏–ø–µ–¥–∏–∏ ‚Äî –æ—Ç–∫—Ä–æ–π –¥–ª—è —Å–µ–±—è –æ—Å—å–º–∏–Ω–æ–≥–æ–≤-–∏–Ω–æ–ø–ª–∞–Ω–µ—Ç—è–Ω –∏–ª–∏ –ª—è–≥—É—à–µ–∫-–ø—Ä—è—Ç–æ–∫.",
        "üé≤ –î–µ–ª–∞–π —ç—Ç–æ —Ä–∏—Ç—É–∞–ª–æ–º ‚Äî –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –Ω–æ–≤–∞—è —Ç–µ–º–∞, –∏ –æ–Ω–∞ –≤—Å–µ–≥–¥–∞ –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–∞—è.",
        "üß© –ü—Ä–æ–π–¥–∏ —Ç–µ—Å—Ç –Ω–∞ IQ –∏–ª–∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç ‚Äî —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ç—ã –∑–∞–≥–∞–¥–∫–∞ –¥–ª—è —Å–µ–±—è.",
        "ü™û –û–±—ä—è—Å–Ω–∏ —Å–ª–æ–∂–Ω—É—é —Ç–µ–º—É —Å–µ–±–µ –≤ –∑–µ—Ä–∫–∞–ª–æ —Å –ø–∞—É–∑–∞–º–∏ –Ω–∞ —Å–º–µ—Ö –∏ ¬´–¥–∞ –Ω—É –Ω–∞—Ñ–∏–≥¬ª.",
        "üéß –í–∫–ª—é—á–∏ –ø–æ–¥–∫–∞—Å—Ç –ø–æ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ–π —Ç–µ–º–µ –∏ –∏—â–∏ –∑–∞–±–∞–≤–Ω—ã–π —Ñ–∞–∫—Ç, —á—Ç–æ–±—ã —É–¥–∏–≤–∏—Ç—å —Å–∞–º–æ–≥–æ —Å–µ–±—è.",
        "ü§Ø –ü–æ–∏—â–∏ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ —Å–ª–æ–≤–æ ¬´–ø–∞—Ä–∞–¥–æ–∫—Å¬ª –∏ —É–¥–∏–≤–ª—è–π—Å—è —ç—Ç–æ–º—É –±–µ–∑—É–º–∏—é.",
        "üåü –°–¥–µ–ª–∞–π –∫–∞—Ä—Ç—É –∂–µ–ª–∞–Ω–∏–π —Å –¥–∏–∫–∏–º–∏ –º–µ—á—Ç–∞–º–∏ ‚Äî –ø–æ–ª–µ—Ç –Ω–∞ –õ—É–Ω—É, –¥—Ä—É–∂–±–∞ —Å –¥—Ä–∞–∫–æ–Ω–æ–º –∏ –ø—Ä–æ—á–µ–µ."
    ],
    "üé≠ –ê—Ä—Ç –∏ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ –±–µ–∑ –Ω–∞–ø—Ä—è–≥–∞": [
        "üöÄ –ù–∞–ø–∏—à–∏ —Ä–∞—Å—Å–∫–∞–∑ –ø—Ä–æ –∫–æ—Å–º–∏—á–µ—Å–∫—É—é –∫–æ—Ä–æ–≤—É, –∫–æ—Ç–æ—Ä–∞—è —Å–ø–∞—Å–∞–µ—Ç –≥–∞–ª–∞–∫—Ç–∏–∫—É ‚Äî –±—É–¥—å —Å—Ç—Ä–∞–Ω–Ω—ã–º –∏ —Å–º–µ—à–Ω—ã–º.",
        "üçï –ù–∞–ø–∏—à–∏ —Å—Ç–∏—à–æ–∫ –æ –ø–∏—Ü—Ü–µ –∏ –≤–µ—á–Ω–æ–π –ø—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ü–∏–∏ ‚Äî –¥–ª—è –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è –∏ —Å–º–µ—Ö–∞.",
        "‚úçÔ∏è –ù–∞—Ä–∏—Å—É–π –∫–∞—Ä–∞–∫—É–ª–∏ ¬´–º–Ω–µ –ª–µ–Ω—å, –Ω–æ —Ö–æ—á–µ—Ç—Å—è¬ª ‚Äî –ø–æ–≤–æ–¥ –ø–æ—Å–º–µ—è—Ç—å—Å—è –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å —à–µ–¥–µ–≤—Ä.",
        "üé• –°–Ω–∏–º–∏ –∫–æ—Ä–æ—Ç–∫–æ–µ –≤–∏–¥–µ–æ, –≥–¥–µ —Ç—ã —Ä–µ–∂–∏—Å—Å—ë—Ä, –Ω–æ –≤—Å—ë –∏–¥—ë—Ç –Ω–µ —Ç–∞–∫ ‚Äî —Å–º–µ–π—Å—è –∏ –º–æ–Ω—Ç–∏—Ä—É–π –±–µ–∑ –ø—Ä–∞–≤–∏–ª.",
        "üëü –ü—Ä–∏–¥—É–º–∞–π –±–ª–æ–∫–±–∞—Å—Ç–µ—Ä —Å –≥–ª–∞–≤–Ω—ã–º –≥–µ—Ä–æ–µ–º ‚Äî —Å–≤–æ–µ–π –æ–±—É–≤—å—é. –ó–≤–µ–∑–¥–∞ deserves —Å–ª–∞–≤—É!",
        "üì∏ –°–¥–µ–ª–∞–π –º–∏–Ω–∏-—Ñ–æ—Ç–æ–∏—Å—Ç–æ—Ä–∏—é –∏–∑ –±—É–¥–∏–ª—å–Ω–∏–∫–∞, –∫—Ä—É–∂–∫–∏ –∏ —Ç–∞–ø–∫–∞ —Å –¥–∏–∞–ª–æ–≥–∞–º–∏."
    ],
    "üí™ –î–ª—è —Ç–µ–ª–∞ (–Ω–æ –±–µ–∑ —Ñ–∞–Ω–∞—Ç–∏–∑–º–∞)": [
        "‚è≥ 7 –º–∏–Ω—É—Ç –ª—ë–≥–∫–æ–π –±–æ–ª–∏ ‚Äî –∏ —Ç—ã –ø–æ—á—Ç–∏ —Å—É–ø–µ—Ä–≥–µ—Ä–æ–π (–ø–ª–∞—â –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è).",
        "üö∂‚Äç‚ôÇÔ∏è –í—ã—Ö–æ–¥–∏ –Ω–∞ —É–ª–∏—Ü—É —Å –ø–æ–¥–∫–∞—Å—Ç–æ–º –ø—Ä–æ –±–∞–Ω–¥–∏—Ç–æ–≤ 90-—Ö –∏–ª–∏ –¥–µ—Ä–µ–≤–µ–Ω—Å–∫—É—é –∂–∏–∑–Ω—å –∏ –ø—Ä–æ—Å—Ç–æ –∫–∞–π—Ñ—É–π.",
        "üíÉ –¢–∞–Ω—Ü—É–π, –∫–∞–∫ –±—É–¥—Ç–æ –Ω–∏–∫—Ç–æ –Ω–µ —Å–º–æ—Ç—Ä–∏—Ç ‚Äî –¥–∞–∂–µ –µ—Å–ª–∏ —Å–º–æ—Ç—Ä—è—Ç, –≤—Å—ë —Ä–∞–≤–Ω–æ —Ç–∞–Ω—Ü—É–π.",
        "üå¨ –°–¥–µ–ª–∞–π 10 –º–∏–Ω—É—Ç –¥—ã—Ö–∞—Ç–µ–ª—å–Ω–æ–π –≥–∏–º–Ω–∞—Å—Ç–∏–∫–∏ ‚Äî –Ω–µ –∑–∞—Å—ã–ø–∞–π!",
        "üî• –£—Å—Ç—Ä–æ–π —Ç–∞–Ω—Ü–ø–æ–ª —É —Å–µ–±—è –≤ –∫–æ–º–Ω–∞—Ç–µ –ø–æ–¥ –ª—é–±–∏–º—ã–π —Ç—Ä–µ–∫ ‚Äî –∑–≤–µ–∑–¥–∞ –∫–ª—É–±–∞ –≤ –¥–µ–ª–µ.",
        "üèÉ‚Äç‚ôÇÔ∏è –ü—Ä–æ–±–µ–≥–∏ –ª—ë–≥–∫—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî —É—Å—Ç–∞–ª? –ì–æ–≤–æ—Ä–∏, —á—Ç–æ —ç—Ç–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–∞—è –ø–∞—É–∑–∞.",
        "üèÜ –ü—Ä–∏–¥—É–º–∞–π –º–∏–Ω–∏-—Ä–∏—Ç—É–∞–ª ‚Äî 10 –ø—Ä—ã–∂–∫–æ–≤, 5 –æ—Ç–∂–∏–º–∞–Ω–∏–π –∏ —Ç–∞–Ω–µ—Ü –ø–æ–±–µ–¥—ã, –¥–µ–ª–∞–π –∫–æ–≥–¥–∞ —Ö–æ—á–µ—à—å.",
        "üê¢ –°—Ç–∞–Ω—å –º–∞—Å—Ç–µ—Ä–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è ‚Äî —Ä–∞—Å—Ç—è–∂–∫–∞ –∏–ª–∏ –ø–æ—Ö–æ–¥–∫–∞ –≤ —Å—Ç–∏–ª–µ ¬´–º–µ–¥–ª–µ–Ω–Ω–æ –∏ —Å—Ç–∏–ª—å–Ω–æ¬ª.",
        "üßò‚Äç‚ôÇÔ∏è –ü–æ–ø—Ä–æ–±—É–π –π–æ–≥—É –¥–ª—è –ª–µ–Ω–∏–≤—ã—Ö ‚Äî –ø–æ–∑—ã –∫–∞–∫ –¥–ª—è —Å–Ω–∞, –Ω–æ —Å –ø–æ–ª—å–∑–æ–π."
    ],
    "üéÆ –ò–≥—Ä—ã, —á—Ç–æ–±—ã –ø—Ä–æ—Å—Ç–æ –∫–∞–π—Ñ–∞–Ω—É—Ç—å": [
        "üêê –ò–≥—Ä–∞–π –≤ —Å—Ç—Ä–∞–Ω–Ω—ã–π —Å–∏–º—É–ª—è—Ç–æ—Ä –∫–æ–∑–ª–∞, –≥—É—Å—è —Å –º–∏—Å—Å–∏–µ–π –∏–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ–≤–æ–æ–±—Ä–∞–∑–∏–º–æ–µ.",
        "üÉè –ö–∞—Ä—Ç–æ—á–Ω—ã–µ –∏–≥—Ä—ã —Å–æ–ª–æ ‚Äî —É—á–∏—Å—å –±–∏—Ç—å —Å–∞–º–æ–≥–æ —Å–µ–±—è –∏ –≤—ã–∏–≥—Ä—ã–≤–∞—Ç—å.",
        "üë∂ –í—Å–ø–æ–º–Ω–∏ —Å–µ–±—è —Ä–µ–±—ë–Ω–∫–æ–º –±–µ–∑ –ø—Ä–∞–≤–∏–ª –∏ –ø—Ä–æ—Å—Ç–æ –∫–∞–π—Ñ—É–π –æ—Ç –ø—Ä–æ—Ü–µ—Å—Å–∞.",
        "üß∏ –ò–≥—Ä–∞–π –≤ ¬´—á—Ç–æ –µ—Å–ª–∏¬ª ‚Äî –≤—Ä–∞–≥–∏ –ø–ª—é—à–µ–≤—ã–µ –º–∏—à–∫–∏, –ø—Ä–æ—Å—Ç–æ —Ñ–∞–Ω—Ç–∞–∑–∏—Ä—É–π –∏ –Ω–∞—Å–ª–∞–∂–¥–∞–π—Å—è.",
        "üß© –ó–∞–ø—É—Å—Ç–∏ –ø–∞–∑–ª –∏ —Å–æ–±–∏—Ä–∞–π –µ–≥–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –º–µ–¥–ª–µ–Ω–Ω–æ, —á—Ç–æ–±—ã –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å –∞–±—Å—É—Ä–¥.",
        "üé§ –°–ª–æ–≤–µ—Å–Ω—ã–µ –∏–≥—Ä—ã ‚Äî —Ä–∏—Ñ–º—É–π —Å–ª–æ–≤–∞ —Å ¬´–ø–µ–ª—å–º–µ–Ω–∏¬ª –∏ ¬´–≥–æ—Ä–æ—à–µ–∫¬ª, —Å–º–µ–π—Å—è –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–π.",
        "üéÆ –ó–∞–ø—É—Å—Ç–∏ —Å—Ç–∞—Ä—É—é –∏–≥—Ä—É –∏ –≤—Å–ø–æ–º–Ω–∏ –∫–∞–π—Ñ –ø—Ä–æ—Å—Ç–æ –Ω–∞–∂–∏–º–∞—Ç—å –∫–Ω–æ–ø–∫–∏ –±–µ–∑ —Å–º—ã—Å–ª–∞.",
        "üåç –ü–æ—Ñ–∞–Ω—Ç–∞–∑–∏—Ä—É–π –ø—Ä–æ —Å–≤–æ–π –º–∏—Ä –∏ –∏–≥—Ä—É —Ç–∞–º ‚Äî —Ä–∏—Å—É–π –≤ –≥–æ–ª–æ–≤–µ –∏ –∑–∞–ø–∏—Å—ã–≤–∞–π –∏–¥–µ–∏."
    ]
}

arsenals_–∑–∞—Ä—è–¥–æ–∫ = {
    "–∑–∞—Ä—è–¥–∫–∞_–≤–∞—Ä–∏–∞–Ω—Ç_1": [
        "–£—Ç—Ä–µ–Ω–Ω—è—è –∑–∞—Ä—è–¥–∫–∞ –Ω–∞ 10 –º–∏–Ω—É—Ç ‚Äî –≤–∫–ª—é—á–∞–π—Å—è –≤ –¥—Ä–∞–π–≤! ‚ö°Ô∏èüî•\n"
        "1. –†–∞–∑–æ–≥—Ä–µ–≤ (2 –º–∏–Ω)\n"
        "üëã –ú–∞—Ö–∏ —Ä—É–∫–∞–º–∏ –≤–ø–µ—Ä—ë–¥ –∏ –Ω–∞–∑–∞–¥ ‚Äî 30 —Å–µ–∫\n"
        "üîÑ –ö—Ä—É–≥–æ–≤—ã–µ –≤—Ä–∞—â–µ–Ω–∏—è –ø–ª–µ—á–∞–º–∏ ‚Äî 30 —Å–µ–∫ (–≤–ø–µ—Ä—ë–¥ –∏ –Ω–∞–∑–∞–¥)\n"
        "ü§∏‚Äç‚ôÇÔ∏è –ù–∞–∫–ª–æ–Ω—ã –≥–æ–ª–æ–≤—ã –∏ –ª—ë–≥–∫–∏–µ –ø–æ–≤–æ—Ä–æ—Ç—ã ‚Äî 30 —Å–µ–∫\n"
        "üèÉ‚Äç‚ôÇÔ∏è –õ—ë–≥–∫–∏–π –±–µ–≥ –Ω–∞ –º–µ—Å—Ç–µ —Å –ø–æ–¥–Ω—è—Ç–∏–µ–º –∫–æ–ª–µ–Ω ‚Äî 30 —Å–µ–∫\n\n"
        "2. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å (4 –º–∏–Ω)\n"
        "‚ú® –ü—Ä—ã–∂–∫–∏ ¬´–∑–≤—ë–∑–¥–æ—á–∫–∞¬ª ‚Äî 40 —Ä–∞–∑ (—Ä–∞–∑–º–∏–Ω–∞–π —Å—É—Å—Ç–∞–≤—ã)\n"
        "ü¶µ –ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å —Ä—É–∫–∞–º–∏ –≤–≤–µ—Ä—Ö ‚Äî 20 —Ä–∞–∑ (–Ω–µ –Ω–∞–¥–æ –≥–ª—É–±–æ–∫–æ, –≥–ª–∞–≤–Ω–æ–µ ‚Äî –¥–≤–∏–∂–µ–Ω–∏–µ)\n"
        "üö∂‚Äç‚ôÇÔ∏è –í—ã–ø–∞–¥—ã –≤–ø–µ—Ä—ë–¥ ‚Äî –ø–æ 10 –Ω–∞ –∫–∞–∂–¥—É—é –Ω–æ–≥—É (—á—É—Ç—å —Ä–∞—Å—Ç—è–≥–∏–≤–∞–µ–º –±—ë–¥—Ä–∞)\n"
        "üí™ –û—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç —Å—Ç–µ–Ω—ã –∏–ª–∏ –ø–æ–ª–∞ ‚Äî 15 —Ä–∞–∑ (—á—É—Ç—å –Ω–∞–ø—Ä—è–≥–∏ —Ä—É–∫–∏ –∏ –≥—Ä—É–¥—å)\n\n"
        "3. –°–∏–ª–∞ –∏ –±–∞–ª–∞–Ω—Å (2,5 –º–∏–Ω)\n"
        "üßò‚Äç‚ôÇÔ∏è –ü–ª–∞–Ω–∫–∞ –Ω–∞ –ª–æ–∫—Ç—è—Ö ‚Äî –¥–µ—Ä–∂–∏ 45 —Å–µ–∫—É–Ω–¥, –¥—ã—à–∏ —Ä–æ–≤–Ω–æ\n"
        "üçë –ü–æ–¥—ä—ë–º—ã —Ç–∞–∑–∞ –ª—ë–∂–∞ ‚Äî 20 —Ä–∞–∑ (–≤–∫–ª—é—á–∞–π —è–≥–æ–¥–∏—Ü—ã, –Ω–µ —Å–ø–∏–Ω—É)\n"
        "ü¶∂ –ë–∞–ª–∞–Ω—Å –Ω–∞ –æ–¥–Ω–æ–π –Ω–æ–≥–µ ‚Äî –ø–æ 30 —Å–µ–∫ –Ω–∞ –∫–∞–∂–¥—É—é –Ω–æ–≥—É, —Ä—É–∫–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—ã (–≤–∫–ª—é—á–∞–µ–º –º–æ–∑–≥ –∏ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—é)\n\n"
        "4. –†–∞—Å—Ç—è–∂–∫–∞ –∏ —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ (1,5 –º–∏–Ω)\n"
        "üôÜ‚Äç‚ôÇÔ∏è –ù–∞–∫–ª–æ–Ω—ã –≤–ø–µ—Ä—ë–¥, –ø—ã—Ç–∞—è—Å—å –¥–æ—Ç—è–Ω—É—Ç—å—Å—è –¥–æ –ø–∞–ª—å—Ü–µ–≤ –Ω–æ–≥ ‚Äî 30 —Å–µ–∫ (–±–µ–∑ —Ñ–∞–Ω–∞—Ç–∏–∑–º–∞!)\n"
        "üò∫ –ü–æ—Ç—è–≥–∏–≤–∞–Ω–∏—è —Å—Ç–æ—è ‚Äî —Ä—É–∫–∏ –≤–≤–µ—Ä—Ö, —Ç—è–Ω–∏—Å—å –∫–∞–∫ –∫–æ—à–∫–∞ –ø–æ—Å–ª–µ —Å–Ω–∞ ‚Äî 30 —Å–µ–∫\n"
        "üå¨Ô∏è –ì–ª—É–±–æ–∫–∏–µ –≤–¥–æ—Ö–∏ —Å –ø–æ–¥–Ω—è—Ç—ã–º–∏ —Ä—É–∫–∞–º–∏ –∏ –≤—ã–¥–æ—Ö–∏ —Å –æ–ø—É—Å–∫–∞–Ω–∏–µ–º ‚Äî 30 —Å–µ–∫"
    ],
    "–∑–∞—Ä—è–¥–∫–∞_–≤–∞—Ä–∏–∞–Ω—Ç_2": [
"""–ó–∞—Ä—è–¥–∫–∞ –≤–∞—Ä–∏–∞–Ω—Ç 2 ‚Äî –≤–∑–±–æ–¥—Ä–∏—Å—å –∏ –∑–∞–∂–≥–∏! ‚ö°Ô∏èüî•
1. –†–∞–∑–æ–≥—Ä–µ–≤ (2 –º–∏–Ω)
ü§∏‚Äç‚ôÄÔ∏è –ö—Ä—É–≥–æ–≤—ã–µ –º–∞—Ö–∏ –Ω–æ–≥–∞–º–∏ –≤–ø–µ—Ä—ë–¥-–Ω–∞–∑–∞–¥ ‚Äî –ø–æ 30 —Å–µ–∫ –Ω–∞ –∫–∞–∂–¥—É—é –Ω–æ–≥—É
üëê –†–∞–∑–≤–æ–¥–∏–º —Ä—É–∫–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—ã –∏ —Å–æ–±–∏—Ä–∞–µ–º –≤–º–µ—Å—Ç–µ ‚Äî 1 –º–∏–Ω, –ø–ª–∞–≤–Ω–æ, —á—Ç–æ–±—ã —Ä–∞–∑–æ–≥—Ä–µ—Ç—å –ø–ª–µ—á–∏ –∏ –≥—Ä—É–¥—å

2. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å (4 –º–∏–Ω)
üèÉ‚Äç‚ôÇÔ∏è –ë–µ–≥ –Ω–∞ –º–µ—Å—Ç–µ —Å –∑–∞—Ö–ª—ë—Å—Ç–æ–º –ø—è—Ç–æ–∫ –∫ —è–≥–æ–¥–∏—Ü–∞–º ‚Äî 40 —Å–µ–∫—É–Ω–¥
ü¶µ –ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å –ø–æ–≤–æ—Ä–æ—Ç–æ–º –∫–æ—Ä–ø—É—Å–∞ –≤ —Å—Ç–æ—Ä–æ–Ω—É ‚Äî 15 —Ä–∞–∑ –Ω–∞ –∫–∞–∂–¥—É—é —Å—Ç–æ—Ä–æ–Ω—É (–≤–∫–ª—é—á–∞–µ–º –∫–æ—Å—ã–µ –º—ã—à—Ü—ã)
üêæ –®–∞–≥–∏ "–∫—Ä–∞–±–æ–º" –≤–ª–µ–≤–æ-–≤–ø—Ä–∞–≤–æ ‚Äî 1 –º–∏–Ω—É—Ç–∞ (–¥–ª—è –±–æ–∫–æ–≤–æ–π —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏)
üí™ –û—Ç–∂–∏–º–∞–Ω–∏—è —Å –∫–æ–ª–µ–Ω ‚Äî 20 —Ä–∞–∑ (—á—É—Ç—å –ø–æ–ª–µ–≥—á–µ, –Ω–æ —Å —á—É–≤—Å—Ç–≤–æ–º)

3. –°–∏–ª–∞ –∏ –±–∞–ª–∞–Ω—Å (2,5 –º–∏–Ω)
üßò‚Äç‚ôÄÔ∏è –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–ø–∞–¥ ‚Äî –¥–µ—Ä–∂–∏–º –ø–æ 30 —Å–µ–∫ –Ω–∞ –∫–∞–∂–¥—É—é –Ω–æ–≥—É, —Ä—É–∫–∏ –≤–≤–µ—Ä—Ö (—Ç—É—Ç –∏ –±–∞–ª–∞–Ω—Å, –∏ —Ä–∞—Å—Ç—è–∂–∫–∞)
üçë –ú–æ—Å—Ç–∏–∫ –Ω–∞ —è–≥–æ–¥–∏—Ü—ã —Å –ø–æ–¥–Ω—è—Ç–æ–π –Ω–æ–≥–æ–π ‚Äî –ø–æ 15 —Ä–∞–∑ –Ω–∞ –∫–∞–∂–¥—É—é –Ω–æ–≥—É
ü¶∂ –ë–∞–ª–∞–Ω—Å –Ω–∞ –æ–¥–Ω–æ–π –Ω–æ–≥–µ —Å –∑–∞–∫—Ä—ã—Ç—ã–º–∏ –≥–ª–∞–∑–∞–º–∏ ‚Äî –ø–æ 20 —Å–µ–∫ (–µ—Å–ª–∏ –Ω–µ —É–ø–∞–ª ‚Äî –≥–µ—Ä–æ–π!)

4. –†–∞—Å—Ç—è–∂–∫–∞ –∏ —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ (1,5 –º–∏–Ω)
üôá‚Äç‚ôÇÔ∏è –ù–∞–∫–ª–æ–Ω—ã –≥–æ–ª–æ–≤—ã –≤ —Å—Ç–æ—Ä–æ–Ω—ã ‚Äî –ø–æ 20 —Å–µ–∫ –Ω–∞ –∫–∞–∂–¥—É—é —Å—Ç–æ—Ä–æ–Ω—É
üëê –ü–æ—Ç—è–≥–∏–≤–∞–Ω–∏—è –≤–ø–µ—Ä—ë–¥, –ø—ã—Ç–∞—è—Å—å –¥–æ—Ç—è–Ω—É—Ç—å—Å—è –¥–æ –ø–æ–ª–∞ ‚Äî 30 —Å–µ–∫ (–±–µ–∑ —Ñ–∞–Ω–∞—Ç–∏–∑–º–∞)
üå¨Ô∏è –ì–ª—É–±–æ–∫–∏–µ –≤–¥–æ—Ö–∏ —á–µ—Ä–µ–∑ –Ω–æ—Å, –≤—ã–¥–æ—Ö —á–µ—Ä–µ–∑ —Ä–æ—Ç ‚Äî 30 —Å–µ–∫, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–π, –∫–∞–∫ –≤—Å—è —É—Å—Ç–∞–ª–æ—Å—Ç—å —É—Ö–æ–¥–∏—Ç –ø—Ä–æ—á—å"""

    ],
}


async def random_skuki(update: Update, context: ContextTypes.DEFAULT_TYPE):
    # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –∞—Ä—Å–µ–Ω–∞–ª
    arsenal_name = random.choice(list(arsenals.keys()))
    task = random.choice(arsenals[arsenal_name])
    await update.message.reply_text(f"–í–æ—Ç —Ç–µ–±–µ —Å–ª—É—á–∞–π–Ω–∞—è –∏–¥–µ—è –∏–∑ –∞—Ä—Å–µ–Ω–∞–ª–∞ - \n**{arsenal_name}**:")
    await update.message.reply_text(f"{task}")

async def random_zaryadki(update: Update, context: ContextTypes.DEFAULT_TYPE):
    arsenal_name = random.choice(list(arsenals_–∑–∞—Ä—è–¥–æ–∫.keys()))
    task = random.choice(arsenals_–∑–∞—Ä—è–¥–æ–∫[arsenal_name])
    await update.message.reply_text(f"–í–æ—Ç —Ç–µ–±–µ —Å–ª—É—á–∞–π–Ω–∞—è –∑–∞—Ä—è–¥–∫–∞ –î–ï–ô–°–¢–í–£–ô - \n**{arsenal_name}**:")
    await update.message.reply_text(task)


async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text("–ü—Ä–∏–≤–µ—Ç! –Ø —Ç–≤–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –±–æ—Ç üí™")

async def help_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    help_text = (
        "–Ø –º–æ–≥—É –ø–æ–º–æ—á—å —Ç–µ–±–µ —Å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞–º–∏!\n\n"
        "–ö–æ–º–∞–Ω–¥—ã:\n"
        "/start - –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞\n"
        "/help - –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ\n"
        "/go - –ù–∞—á–∞—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä —Å –ò–ò\n"
        "/exit - –í—ã–π—Ç–∏ –∏–∑ —Ä–µ–∂–∏–º–∞ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞\n"
    )
    await update.message.reply_text(help_text)

async def set_commands(application):
    commands = [
    BotCommand("start", "–ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞"),
    BotCommand("help", "–ü–æ–º–æ—â—å"),
    BotCommand("go", "–ù–∞—á–∞—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä"),
    BotCommand("exit", "–í—ã–π—Ç–∏ –∏–∑ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞"),
    BotCommand("random_skuki", "–ü–æ–ª—É—á–∏—Ç—å —Å–ª—É—á–∞–π–Ω—É—é –∏–¥–µ—é –¥–ª—è –∑–∞–Ω—è—Ç–∏—è"),
    BotCommand("random_zaryadki", "–ü–æ–ª—É—á–∏—Ç—å —Å–ª—É—á–∞–π–Ω—É—é –∑–∞—Ä—è–¥–∫—É"),
]
    await application.bot.set_my_commands(commands)

async def echo(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    user_message = update.message.text

    if user_id in chat_users:
        try:
            response = await client.chat.completions.create(
                model="gpt-4o-mini",
                messages=[
                    {"role": "system", "content": "–¢—ã –≤–µ–¥–µ—à—å —Å–µ–±—è –∫–∞–∫ –¥—Ä—É–≥ –∏ —Ç–æ–≤–∞—Ä–∏—â. –ü—Ä–∏–≤–æ–¥–∏—à—å –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –ª—É—á—à–µ–≥–æ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è"},
                    {"role": "user", "content": user_message}
                ]
            )

            reply = response.choices[0].message.content

            prompt_tokens = response.usage.prompt_tokens
            completion_tokens = response.usage.completion_tokens
            total_tokens = response.usage.total_tokens

            # –¶–µ–Ω–∞: $0.15 –∑–∞ 1000 —Ç–æ–∫–µ–Ω–æ–≤ ‚Üí 0.00015 –∑–∞ 1 —Ç–æ–∫–µ–Ω
            price_per_token = 0.15 / 1000
            cost = total_tokens * price_per_token

            await update.message.reply_text(reply)
            await update.message.reply_text(
                f"üî¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ —Ç–æ–∫–µ–Ω–æ–≤:\n"
                f"üì• –í–≤–æ–¥: {prompt_tokens}\n"
                f"üì§ –û—Ç–≤–µ—Ç: {completion_tokens}\n"
                f"üí° –í—Å–µ–≥–æ: {total_tokens}\n\n"
                f"üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞: ${cost:.6f}"
            )
        except Exception as e:
            logging.error(f"–û—à–∏–±–∫–∞ OpenAI API: {e}")
            await update.message.reply_text("–ò–∑–≤–∏–Ω–∏, –≤–æ–∑–Ω–∏–∫–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞.")
    else:
        await update.message.reply_text(f"–¢—ã –Ω–∞–ø–∏—Å–∞–ª: {user_message}")

async def unknown(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text("–ò–∑–≤–∏–Ω–∏, —è –Ω–µ –∑–Ω–∞—é —Ç–∞–∫–æ–π –∫–æ–º–∞–Ω–¥—ã.")

async def go(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    chat_users.add(user_id)
    await update.message.reply_text("üß† –¢—ã –≤–æ—à—ë–ª –≤ —Ä–µ–∂–∏–º –æ–±—â–µ–Ω–∏—è —Å –ò–ò. –ü–∏—à–∏ —á—Ç–æ —É–≥–æ–¥–Ω–æ!\n\n–ù–∞–ø–∏—à–∏ /exit —á—Ç–æ–±—ã –≤—ã–π—Ç–∏.")

async def exit_chat(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    if user_id in chat_users:
        chat_users.remove(user_id)
        await update.message.reply_text("‚úÖ –¢—ã –≤—ã—à–µ–ª –∏–∑ —Ä–µ–∂–∏–º–∞ –æ–±—â–µ–Ω–∏—è —Å –ò–ò.")
    else:
        await update.message.reply_text("–¢—ã –∏ —Ç–∞–∫ –Ω–µ –≤ —Ä–µ–∂–∏–º–µ –æ–±—â–µ–Ω–∏—è —Å –ò–ò.")

async def main():
    app = ApplicationBuilder().token(TOKEN).build()

    app.add_handler(CommandHandler("start", start))
    app.add_handler(CommandHandler("help", help_command))
    app.add_handler(CommandHandler("go", go))
    app.add_handler(CommandHandler("exit", exit_chat))
    app.add_handler(CommandHandler("random_skuki", random_skuki))
    app.add_handler(CommandHandler("random_zaryadki", random_zaryadki))


    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, echo))
    app.add_handler(MessageHandler(filters.COMMAND, unknown))

    await set_commands(app)

    print("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω...")
    await app.run_webhook(
        listen="0.0.0.0",  # –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –≤—Å–µ–º –∞–¥—Ä–µ—Å–∞–º
        port=int(os.getenv("PORT", 5000)),  # –ü–æ—Ä—Ç –¥–ª—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è
        url_path=TOKEN,  # –ü—É—Ç—å –∫ —Ç–æ–∫–µ–Ω—É –≤ URL
        webhook_url=f"{WEBHOOK_URL}/{TOKEN}",  # –í–µ–±—Ö—É–∫ URL
    )

if __name__ == "__main__":
    asyncio.run(main())
